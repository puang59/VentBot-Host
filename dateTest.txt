from discord.ext import commands
import discord
import asyncio
import os
from random import *

from pymongo import MongoClient

intents = discord.Intents.all()
intents.members = True


global cluster
global db
global collection
cluster = MongoClient(
    "mongodb+srv://Edryu:jaisairam4@cluster0.inbe1.mongodb.net/myFirstDatabase?retryWrites=true&w=majority")
db = cluster["Discord"]
collection = db["vent"]
prof = db["ventProf"]
inbox = db['ventInbox']

vCheck = db["ventCheck"]
stories = db['webVent']

ventText = stories.find_one({"guild": "vent"})

bot = commands.Bot(command_prefix=".", intents=intents, activity=discord.Activity(type=discord.ActivityType.listening, name=f"{ventText['stories']}+ stories"))
bot.remove_command("help")

async def load_cogs():
    for filename in os.listdir("./cogs"):
        if filename.endswith(".py"):
            await bot.load_extension(f"cogs.{filename[:-3]}")

async def main():
    async with bot:
        await load_cogs()
        print("Cogs Loadd\nBot ready!")
        await bot.start('OTYyNjAzODQ2Njk2MzM3NDA4.GazOQC.P1jXz9ZcqnT6ZAbnpE9NNJVVd5M53K-04VDHTs')

asyncio.run(main())
            
            
